CREATE TABLE Ocurrencias (
    Proceso VARCHAR,
    Mensaje VARCHAR,
    Ocurrencia INT
);

INSERT INTO Ocurrencias VALUES
('Web', 'Error:No se puede dividir por 0', 3),
('RestAPI', 'Error:Fallo la conversión', 5),
('App', 'Error:Fallo la conversión', 7),
('RestAPI', 'Error:Error sin identificar', 9),
('Web', 'Error:Error sin identificar', 1),
('App', 'Error:Error sin identificar', 10),
('Web', 'Estado Completado', 8),
('RestAPI', 'Estado Completado', 6);

WITH MaxOcurrencias AS (
    SELECT
        Mensaje,
        MAX(Ocurrencia) AS MaxOcurrencia 
    FROM Ocurrencias 
    GROUP BY Mensaje
)
SELECT
    1.Proceso,
    1.Mensaje,
    1.Ocurrencia 
FROM Ocurrencias 1
JOIN MaxOcurrencias mo 
    ON 1.Mensaje = mo.Mensaje AND 1.Ocurrencia = MaxOcurrencia;
